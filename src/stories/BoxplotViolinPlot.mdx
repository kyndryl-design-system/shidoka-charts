import { Meta, Story, Canvas, Controls, Stories } from '@storybook/blocks';

<Meta title="Third Party Charts/Boxplot & Violin Plot/ðŸ“˜ General Docs" />

# Boxplot & Violin Plot Charts

Boxplot and Violin Plot chart types are available in the Shidoka Charts library through the integration of the [`@sgratzl/chartjs-chart-boxplot`](https://www.sgratzl.com/chartjs-chart-boxplot/) package.

## Overview

Boxplots and violin plots are statistical visualization methods used to display the distribution of data and identify outliers.

### Boxplot

A boxplot (also known as a box and whisker plot) visualizes:

- **Quartiles**: Shows Q1 (25th percentile), median/Q2 (50th percentile), and Q3 (75th percentile) as a box
- **Whiskers**: Lines extending from the box indicating variability outside the upper and lower quartiles
- **Outliers**: Individual points beyond the whiskers, representing unusual values in the dataset

### Violin Plot

A violin plot combines:

- **Density visualization**: Shows the probability density of data at different values
- **Boxplot elements**: Can include median, quartile marks, and outlier points inside the density shape

This provides both the statistical summary of a boxplot with the full distribution shape information.

## Basic Usage

### Boxplot Example

```javascript
const boxplotExample = () => {
  return html`
    <kd-chart
      chartTitle="Boxplot Example"
      description="An example boxplot chart showing distribution of values"
      type="boxplot"
      .labels=${['January', 'February', 'March', 'April']}
      .datasets=${[
        {
          label: 'Dataset 1',
          data: [
            [10, 20, 30, 40, 50, 60, 70, 80], // January data points
            [15, 25, 35, 45, 55, 65, 75], // February data points
            [5, 10, 15, 20, 25, 30, 35, 40], // March data points
            [30, 40, 50, 60, 70, 80, 90], // April data points
          ],
          // colors automatically sourced from the Shidoka Data Viz palette
        },
      ]}
      .options=${{
        colorPalette: 'categorical', // use the Shidoka Data Viz categorical palette
      }}
    ></kd-chart>
  `;
};
```

### Violin Plot Example

```javascript
const violinExample = () => {
  return html`
    <kd-chart
      chartTitle="Violin Plot Example"
      description="An example violin plot showing distribution density"
      type="violin"
      .labels=${['January', 'February', 'March', 'April']}
      .datasets=${[
        {
          label: 'Dataset 1',
          data: [
            [10, 20, 30, 40, 50, 60, 70, 80], // January data points
            [15, 25, 35, 45, 55, 65, 75], // February data points
            [5, 10, 15, 20, 25, 30, 35, 40], // March data points
            [30, 40, 50, 60, 70, 80, 90], // April data points
          ],
          // Colors automatically sourced from the Shidoka Data Viz categorical palette
        },
      ]}
      .options=${{
        colorPalette: 'categorical', // Use the Shidoka Data Viz categorical palette
      }}
    ></kd-chart>
  `;
};
```

### Data Structure

For both boxplot and violin plot, the data structure is an array of arrays:

```javascript
data: [
  [10, 20, 30, 40, 50], // Data points for first label (e.g., January)
  [15, 25, 35, 45, 55], // Data points for second label (e.g., February)
  // ... and so on
];
```

## Customization Options

### Chart Orientation

Boxplots and violin plots can be displayed in either vertical (default) or horizontal orientation.

Use the `chartOrientation` parameter to set the desired orientation:

```javascript
// In your component props or story args
chartOrientation: 'horizontal', // or 'vertical'

// This gets translated in the template to:
.options=${{
  indexAxis: chartOrientation === 'horizontal' ? 'y' : 'x',
  // other options...
}}
```

### Color Palettes

The Shidoka Charts library provides several data visualization color palettes that can be applied to boxplots and violin plots:

```javascript
.options=${{
  colorPalette: 'categorical', // Default palette for most charts
  // Other available palettes:
  // 'sequential01' through 'sequential05' - Sequential color scales
  // 'divergent01', 'divergent02' - Divergent color scales
  // 'rag03', 'rag08' - Red/Amber/Green color sets
}}
```

The color palettes are defined using Shidoka design tokens:

- **Categorical**: `--kd-color-data-viz-categorical-01-01` through `--kd-color-data-viz-categorical-01-10`
- **Sequential**: Various sequential scales from light to dark
- **Divergent**: Scales that diverge from a neutral midpoint
- **RAG**: Red/Amber/Green palettes for status indications

### Boxplot Dataset Options

Boxplots use the following data structure:

```javascript
.datasets=${[
  {
    label: 'Example Dataset', // Name of the dataset
    data: [
      [10, 20, 30, 40, 50, 60, 70, 80], // Data points for first label
      [15, 25, 35, 45, 55, 65, 75],     // Data points for second label
      // ... additional arrays for each label
    ]
  }
]}
```

The styling for boxplots is automatically applied based on the selected color palette.

### Violin Plot Dataset Options

Violin plots use the same data structure as boxplots:

```javascript
.datasets=${[
  {
    label: 'Example Dataset', // Name of the dataset
    data: [
      [10, 20, 30, 40, 50, 60, 70, 80], // Data points for first label
      [15, 25, 35, 45, 55, 65, 75],     // Data points for second label
      // ... additional arrays for each label
    ]
  }
]}
```

The styling for violin plots is automatically applied based on the selected color palette. The violin plot provides:

- Smooth violin shapes that display the probability density of data
- Automatically configured violin width
- Points for smoothing the violin curve
- The same outlier handling as boxplots

All visual properties are derived from the selected color palette, making the violin plot ready to use without additional configuration.

### Available Props

Both boxplots and violin plots support the following props:

```javascript
// Main component props
type="boxplot" // or "violin"
chartTitle="Boxplot Example"       // Title of the chart
description="Chart description"    // Description text
labels={['January', 'February'...]} // Labels for categories
datasets={[...]}                   // Data arrays (see above)
chartOrientation="vertical"        // 'vertical' or 'horizontal'
colorPalette="categorical"         // Color palette from Shidoka system
showLegend={false}                 // Whether to display the legend
showTooltip={true}                 // Whether to display tooltips
hideDescription={false}            // Hide the description
hideCaptions={false}               // Hide captions
hideHeader={false}                 // Hide the header
hideControls={false}               // Hide controls
noBorder={false}                   // Remove chart border
width={null}                       // Custom width (null = responsive)
height={null}                      // Custom height (null = responsive)

// Options object for additional configuration
options={{
  // Chart orientation translated internally
  indexAxis: chartOrientation === 'horizontal' ? 'y' : 'x',

  // Color palette (from Shidoka's Data Viz semantic colors)
  colorPalette: 'categorical', // 'categorical', 'sequential01' through 'sequential05', 'divergent01', 'divergent02', etc.

  // Display options
  showLegend: true,            // Whether to display the legend
  showTooltip: true,           // Whether to display tooltips

  // Grid configuration
  gridX: true,                 // Show grid lines on X axis (default depends on orientation)
  gridY: true,                 // Show grid lines on Y axis (default depends on orientation)

  // Axis configuration
  xAxisTitle: 'Categories',    // X-axis title
  yAxisTitle: 'Values',        // Y-axis title
  xAxisMin: null,              // Minimum value for X axis (null = auto)
  xAxisMax: null,              // Maximum value for X axis (null = auto)
  yAxisMin: null,              // Minimum value for Y axis (null = auto)
  yAxisMax: null,              // Maximum value for Y axis (null = auto)

  // Visual styling for both chart types
  backgroundAlpha: '80',       // Alpha transparency for background colors (00-FF hex)
  borderWidth: 1,              // Width of the border around elements

  // Tooltip customization
  tooltipCallbacks: {          // Custom callbacks for tooltip formatting
    // Add custom callbacks here
  },

  // Override options
  chartOptionsOverride: {},    // Override any Chart.js options directly
  datasetOptionsOverride: {},  // Override any dataset options directly
}}
```

### Boxplot Specific Configuration Options

In addition to the shared options, boxplots support these specific configuration options:

```javascript
options={{
  // Outlier configuration
  outlierStyle: 'circle',      // Style of outlier points: 'circle', 'rect', 'triangle', etc.
  outlierRadius: 3,            // Radius of outlier points in pixels
  outlierBorderWidth: 1,       // Border width of outlier points

  // Item configuration (individual data points)
  itemStyle: 'circle',         // Style of individual data points: 'circle', 'rect', 'triangle', etc.
  itemRadius: 0,               // Radius of individual data points (0 = don't show)
  itemBorderWidth: 0,          // Border width of individual data points

  // Background transparency for quartile regions
  lowerBackgroundAlpha: '80',  // Alpha transparency for lower quartile region
  upperBackgroundAlpha: '80',  // Alpha transparency for upper quartile region
}}
```

### Violin Plot Specific Configuration Options

Violin plots have their own specific configuration options:

```javascript
options={{
  // Outlier configuration (same as boxplot)
  outlierStyle: 'circle',      // Style of outlier points: 'circle', 'rect', 'triangle', etc.
  outlierRadius: 3,            // Radius of outlier points in pixels
  outlierBorderWidth: 1,       // Border width of outlier points

  // Mean marker configuration
  meanStyle: 'circle',         // Style of mean marker: 'circle', 'rect', 'triangle', etc.
  meanRadius: 3,               // Radius of mean marker in pixels
  meanBorderWidth: 1,          // Border width of mean marker

  // Violin shape configuration
  pointCount: 100,             // Number of points used to smooth the violin shape
  violinWidth: 0.8,            // Width of violin as a ratio of available space (0 to 1)
}}
```

## Complete Examples

### Boxplot Example

Complete example of a boxplot with multiple datasets:

```javascript
const BoxplotDemo = () => {
  return html`
    <kd-chart
      type="boxplot"
      chartTitle="Boxplot Example"
      description="Performance Metrics for Q1-Q4"
      .labels=${['Q1', 'Q2', 'Q3', 'Q4']}
      .datasets=${[
        {
          label: 'Product A',
          data: [
            [42, 45, 47, 48, 50, 52, 55, 58, 60], // Q1 performance scores
            [44, 48, 49, 50, 52, 54, 56, 58], // Q2 performance scores
            [40, 42, 43, 46, 48, 50, 52], // Q3 performance scores
            [46, 48, 50, 52, 54, 56, 58, 60, 62], // Q4 performance scores
          ],
        },
        {
          label: 'Product B',
          data: [
            [38, 40, 42, 44, 46, 48, 50, 52], // Q1 performance scores
            [40, 42, 44, 46, 48, 50, 52, 54], // Q2 performance scores
            [44, 46, 48, 50, 52, 54, 56, 58, 60], // Q3 performance scores
            [42, 44, 46, 48, 50, 52, 54], // Q4 performance scores
          ],
        },
      ]}
      .options=${{
        colorPalette: 'categorical',
        indexAxis: 'x', // For vertical orientation
        scales: {
          x: {
            title: {
              display: true,
              text: 'Quarterly Results',
            },
          },
          y: {
            title: {
              display: true,
              text: 'Performance Score',
            },
          },
        },
        plugins: {
          legend: {
            display: true, // Show the legend
          },
        },
      }}
      chartOrientation="vertical"
      showLegend=${true}
      ?hideDescription=${false}
      ?hideCaptions=${false}
      ?hideHeader=${false}
      ?hideControls=${false}
      ?noBorder=${false}
    ></kd-chart>
  `;
};
```

### Violin Plot Example

Here's a complete example of a violin plot with multiple datasets:

```javascript
const ViolinDemo = () => {
  return html`
    <kd-chart
      type="violin"
      chartTitle="Violin Plot Example"
      description="Performance Distribution for Q1-Q4"
      .labels=${['Q1', 'Q2', 'Q3', 'Q4']}
      .datasets=${[
        {
          label: 'Product A',
          data: [
            [42, 45, 47, 48, 50, 52, 55, 58, 60], // Q1 performance scores
            [44, 48, 49, 50, 52, 54, 56, 58], // Q2 performance scores
            [40, 42, 43, 46, 48, 50, 52], // Q3 performance scores
            [46, 48, 50, 52, 54, 56, 58, 60, 62], // Q4 performance scores
          ],
        },
        {
          label: 'Product B',
          data: [
            [38, 40, 42, 44, 46, 48, 50, 52], // Q1 performance scores
            [40, 42, 44, 46, 48, 50, 52, 54], // Q2 performance scores
            [44, 46, 48, 50, 52, 54, 56, 58, 60], // Q3 performance scores
            [42, 44, 46, 48, 50, 52, 54], // Q4 performance scores
          ],
        },
      ]}
      .options=${{
        colorPalette: 'sequential02',
        indexAxis: 'x', // For vertical orientation
        scales: {
          x: {
            title: {
              display: true,
              text: 'Quarterly Results',
            },
          },
          y: {
            title: {
              display: true,
              text: 'Performance Score',
            },
          },
        },
        plugins: {
          legend: {
            display: true, // Show the legend
          },
        },
      }}
      chartOrientation="vertical"
      showLegend=${true}
      ?hideDescription=${false}
      ?hideCaptions=${false}
      ?hideHeader=${false}
      ?hideControls=${false}
      ?noBorder=${false}
    ></kd-chart>
  `;
};
```

## Further Resources

For more detailed documentation on the available options, refer to:

- [Box and Whiskers Config Options](https://github.com/sgratzl/chartjs-chart-boxplot/blob/main/src/elements/BoxAndWiskers.ts)
- [Violin Config Options](https://github.com/sgratzl/chartjs-chart-boxplot/blob/main/src/elements/Violin.ts)
